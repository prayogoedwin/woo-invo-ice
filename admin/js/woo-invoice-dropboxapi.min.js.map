{"version":3,"sources":["woo-invoice-dropboxapi.js"],"names":["$","jQuery","WooInvoice","inputSanitization","initialHelper","result","fadeOut","css","html","$sting","setInterval","on","dropboxToggle","is","show","hide","enableDropboxApi","this","ajax","wpifw_ajax_obj_dropboxapi","dataType","data","action","_ajax_nonce","success","_error","console","log","error","url","type","fName","displayFolderQueryResult","lastChar","firstChar","val","trimedValue","trim","dropboxFolder","replace","charAt","slice","document"],"mappings":"aAAA,CAAA,SAACA,GAoKwEC,O,IAjKzEC,EA2JgBC,C,cACJC,W,SAnCQC,EAAOC,G,IACHD,EAAAA,EAAA,yBAAA,E,EACZA,IAAAE,UAAA,OAAA,E,EACHF,KAAAG,CAAAC,E,YAJOC,W,EAMRL,QAAAC,GAAA,C,KACR,C,yCAxHA,EAAAK,GAAAA,SAAA,WACYC,GAAAA,EAAAA,IAAa,EAAAC,GAAG,UAAA,E,qCACd,EAAAC,KAA2CA,E,qCAEpC,EAAAC,KAA2CA,C,2CAUpDC,EAAAA,GAAgBL,SAAa,WAIzB,GAAAX,EAAAiB,IAAA,EAAAJ,GAAA,UAAA,I,0BACc,EAAAN,IAAsB,UAAA,OAAA,E,0CAC9B,EAAAA,IAAiD,UAAA,MAAA,E,qBACjD,EAAAA,IAAA,UAAA,MAA8C,E,OAEhDW,C,8BACOC,0B,KACEA,O,SACMC,O,KACDC,C,OACLC,kC,YACOC,0BAAAJ,K,UAEXK,SAAAA,GAEGA,G,EAAAA,S,0BACmB,EAAAjB,IAAA,UAAM,MAAA,E,0CACnB,EAAAA,IAAA,UAAgD,OAAA,E,qBAChD,EAAAA,IAAA,UAAyC,MAAK,E,oCACzBA,G,sCAMdY,0B,qBAEWC,O,2DAGCD,0BAAAA,K,UAETK,SAASH,GACYG,G,qCACnB,EAAAjB,IAAA,UAAgD,MAAA,E,0CAChD,EAAAA,IAAA,UAAiE,OAAA,E,qBAC5CA,EAAAA,IAAAA,UAAsB,MAAA,I,0BAI3C,EAAAA,IAAA,UAA8C,MAAA,E,0CACzBA,EAAAA,IAAAA,UAAuB,MAAA,E,qBAClD,EAAAA,IAAA,UAAA,OAAA,E,iBAGkBkB,G,YACtBC,CAAAC,C,WAKAA,SAAIC,G,QAChBF,IAAAA,CAAAE,C,gDAaR,EAAAjB,GAAAA,QAAA,W,IAESQ,EAAAA,EAAAA,IAAAA,EAAAA,IAAAA,E,OAEGD,C,IACHW,0BAAAV,0B,KACOW,O,SACFC,O,KACNR,C,OACHD,yC,MACOS,E,YACJR,0BAAAJ,K,UAEIa,SAAAA,GAEAA,G,EAAAA,Q,EAEJA,qDAAA,E,EAEEJ,wDAAe,C,QAK3BA,SAAAA,G,QACFF,IAAAA,CAAAE,C,4CAqBQK,EAAAA,GAAyCtB,YAAA,W,IACzCuB,EAAAA,EAAmB,uCAAA,EAAAC,IAAAA,EACnBC,EAAAA,EAAcA,KAAiBC,CAAGC,EAElCL,GAAQC,EADZE,EAAAA,QAAAG,KAAA,EAAA,GACsBH,OAAAI,CAAAA,EAClBJ,EAAAA,EAA0BK,MAAYA,CAAAA,CAAAA,EAC1C,KAAAP,I,EACEE,EAAAA,MAAAK,CAAAA,GAET,KAAAR,I,EAJWG,EAAcA,MAAYK,EAAAA,CAAK,CAAC,G,yCAOpD,EAAAN,IAAAA,CAAAC,C,YAaUM,QAACA,EAAS/B,GAAG,QAAQ,W,EAAaT,cAAWE,C,CAAgB,CACtE,EAAEH,MAAM","file":"woo-invoice-dropboxapi.min.js","sourcesContent":["(function($) {\r\n    'use strict';\r\n    /**\r\n     * Woo Invoice Dropbox Backup.\r\n     * @type {{initialHelper: WooInvoice.initialHelper}}\r\n     */\r\n    var WooInvoice = function(){\r\n\r\n        /**\r\n         * Dropbox enable/disable toggle.\r\n         */\r\n        var dropboxToggle = function() {\r\n            $(\"#wpifw_pdf_invoice_upload_to_dropbox\").on('change', function () {\r\n                if( $(this).is(\":checked\") == true) {\r\n                   $('._winvoice_dropbox_client_section').show();\r\n                }else{\r\n                    $('._winvoice_dropbox_client_section').hide();\r\n                }\r\n            });\r\n        };\r\n\r\n        /**\r\n         * Setup dropbox credentials.\r\n         */\r\n        var enableDropboxApi = function(){\r\n            // Enable Dropbox API.\r\n            $(\"#wpifw_pdf_invoice_upload_to_dropbox\").on('change', function () {\r\n\r\n                // Enable upload pdf to dropbox.\r\n                if( $(this).is(\":checked\") == true) {\r\n                    $(\"div#loading-image2 img\").css('display', 'block');\r\n                    $(\"span#success2 .dashicons.dashicons-yes\").css('display', 'none');\r\n                    $(\"div#warning2 span\").css('display', 'none');\r\n                    // Request for checking api file already exist or not.\r\n                    $.ajax({\r\n                        url: wpifw_ajax_obj_dropboxapi.wpifw_ajax_dropboxapi_url,\r\n                        type:'post',\r\n                        dataType: 'json',\r\n                        data:{\r\n                            action: 'woo_invoice_dropboxapi_callback',\r\n                            _ajax_nonce: wpifw_ajax_obj_dropboxapi.nonce,\r\n                        },\r\n                        success:function(data){\r\n                            // Dropbox API file already exist.\r\n                            if(data.success == true) {\r\n                                $(\"div#loading-image2 img\").css('display', 'none');\r\n                                $(\"span#success2 .dashicons.dashicons-yes\").css('display', 'block');\r\n                                $(\"div#warning2 span\").css('display', 'none');\r\n                                alert( 'DropBox API is already exist' );\r\n\r\n                            }else{\r\n                                // Request for downloading api file.\r\n                                $.ajax({\r\n                                    url: wpifw_ajax_obj_dropboxapi.wpifw_ajax_dropboxapi_url,\r\n                                    type:'post',\r\n                                    dataType: 'json',\r\n                                    data:{\r\n                                        action: 'woo_invoice_dropboxapi_download',\r\n                                        _ajax_nonce: wpifw_ajax_obj_dropboxapi.nonce,\r\n                                    },\r\n                                    success:function(data){\r\n                                        if(data.success == true) {\r\n                                            $(\"div#loading-image2 img\").css('display', 'none');\r\n                                            $(\"span#success2 .dashicons.dashicons-yes\").css('display', 'block');\r\n                                            $(\"div#warning2 span\").css('display', 'none');\r\n\r\n                                        }else{\r\n                                            $(\"div#loading-image2 img\").css('display', 'none');\r\n                                            $(\"span#success2 .dashicons.dashicons-yes\").css('display', 'none');\r\n                                            $(\"div#warning2 span\").css('display', 'block');\r\n                                        }\r\n                                    },\r\n                                    error:function(error){\r\n                                        console.log(error)\r\n                                    }\r\n                                })\r\n                            }\r\n                        },\r\n                        error:function(error){\r\n                            console.log(error)\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n\r\n        }\r\n        /**\r\n         * Check folder Existence from dropbox.\r\n         */\r\n        var checkFolderExists = function(){\r\n            $(\"#wpifw_invoice_dropboxapi_folder_path\").on('input', function () {\r\n\r\n                var fName =  $(this).val()\r\n                // Request for checking api file already exist or not.\r\n                $.ajax({\r\n                    url: wpifw_ajax_obj_dropboxapi.wpifw_ajax_dropboxapi_url,\r\n                    type:'post',\r\n                    dataType: 'json',\r\n                    data:{\r\n                        action: 'woo_invoice_check_dropbox_folder_exist',\r\n                        fName:fName,\r\n                        _ajax_nonce: wpifw_ajax_obj_dropboxapi.nonce,\r\n                    },\r\n                    success:function(data){\r\n                        // Dropbox API folder already exist.\r\n                        if(data.success == true) {\r\n                            displayFolderQueryResult(\"This path exist. Invoice will paste on this folder.\")\r\n                        }else{\r\n                            displayFolderQueryResult(\"This path does not exist. This folder will be created.\")\r\n\r\n                        }\r\n                    },\r\n                    error:function(error){\r\n                        console.log(error)\r\n                    }\r\n                })\r\n\r\n            })\r\n            // Callback function for displaying dropbox query result.\r\n            function displayFolderQueryResult($sting ) {\r\n                var result = $('#show_ajax_query_result');\r\n                result.css('display', 'block');\r\n                result.html($sting)\r\n                setInterval(function () {\r\n                    result.fadeOut(3000)\r\n                }, 3000)\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Sanitization for dropbox input.\r\n         */\r\n        var inputSanitization = function(){\r\n            // Remove all whitespace and \"/\" from input value.\r\n            $('#wpifw_invoice_settings_submit_btn').on('mouseover', function () {\r\n                let dropboxFolder    = $('#wpifw_invoice_dropboxapi_folder_path').val();\r\n                let trimedValue      = $.trim( dropboxFolder );\r\n                trimedValue         = trimedValue.replace(/ /g, '');\r\n                let firstChar        =  trimedValue.charAt(0);\r\n                let lastChar         =  trimedValue.slice(-1);\r\n                if( firstChar == '/' ) {\r\n                    trimedValue = trimedValue.slice(1);\r\n                }\r\n                if( lastChar == '/' ) {\r\n                    trimedValue = trimedValue.slice(0, -1)\r\n                }\r\n                $(\"#wpifw_invoice_dropboxapi_folder_path\").val( trimedValue );\r\n            })\r\n        }\r\n\r\n        /**\r\n         * Initialization all function.\r\n         */\r\n        return {\r\n            initialHelper:function(){\r\n                dropboxToggle();\r\n                enableDropboxApi();\r\n                checkFolderExists();\r\n                inputSanitization();\r\n            }\r\n        }\r\n    }(jQuery);\r\n\r\n    /* jQuery ready  */\r\n    jQuery(document).on('ready',function() {WooInvoice.initialHelper();});\r\n})(jQuery);\r\n"]}